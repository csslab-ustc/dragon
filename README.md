# Dragon

## Introduction
This document outlines the Dragon Projectâ€”an educational initiative for studying 
program analysis and optimization techniques on compiler intermediate representations 
(IRs). It specifies the dependencies and operational procedures required to 
configure and execute the project.

## Lab Overview
- Lab 1: [Control-Flow Graph](https://github.com/csslab-ustc/dragon/tree/lab1)
- Lab 2: [Data-flow Analysis](https://github.com/csslab-ustc/dragon/tree/lab2)
- Lab 3: [Optimization](https://github.com/csslab-ustc/dragon/tree/lab3)
- Lab 4: [Lattice]()
- Lab 5: [Static Single-assignment Form]()
- Lab 6: [Interprocedural]()
- Lab 7: [Pointer]()

## Get Dependencies
Before opening the project, you need to download and setup the following dependencies:

1. Download an IDE that fits your needs. We strongly recommend using the latest version of [__JetBrains IntelliJ IDEA__](https://www.jetbrains.com/idea/) (2024.3.5).

2. Download and install [`Java 24`](https://openjdk.org/projects/jdk/24/). 
   
3. Download and install [`Graphviz`](https://graphviz.org/), it's a very popular graph visualization software, to visualize the control-flow graphs generated by your Tiger compiler. Do not forget to add it to your `PATH`. To make sure you have installed graphviz correctly, you can run the following command on your prompt:
```
$ dot --help
Usage: C:\Program Files\Graphviz\bin\dot [-Vv?] [-(GNE)name=val] [-(KTlso)<val>] <dot files>
(additional options for neato)    [-x] [-n<v>]
(additional options for fdp)      [-L(gO)] [-L(nUCT)<val>]
(additional options for config)  [-cv]

 -V          - Print version and exit
 -v          - Enable verbose mode
 -Gname=val  - Set graph attribute 'name' to 'val'
 -Nname=val  - Set node attribute 'name' to 'val'
 -Ename=val  - Set edge attribute 'name' to 'val'
 ...
```

4. Check out the code repository of this project to your machine, you should run the following command:
```
 $ git clone https://github.com/csslab-ustc/dragon.git
```
5. Enter the local repository, switch to a specific lab (e.g. `lab1`):
```
 $ git branch lab1 origin/lab1
 $ git switch lab1
```


## Setup Environment
After the above dependencies are built, you need to set up the environment for your IDE. Take __JetBrains IntelliJ IDEA__ as an example.

1. Open this project with __IntelliJ IDEA__.
   
2. Set __IntelliJ IDEA__ with path `File/Project Structure/SDKs`, add `Java 24` as the default SDK. Then change the `Language level` to `24(Preview)` at path `Project Settings/Project`. If there is no `24(Preview)` option, please update your IDE.
   
3. Enter path `Project Settings/Modules`, choose `Dependencies/+/Libray/from Maven` and add following libraries respectively:
   * `org.antlr:antlr4-runtime:4.13.2`
   * `org.junit.jupiter:junit-jupiter-api:5.8.2`

4. Then you can run the file `src/main/Dragon.java`, the output should be:
```
...
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at main.Dragon.main(Dragon.java:17)

Process finished with exit code 1
```